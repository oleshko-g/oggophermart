// Package balance is an implementation of [genBalance] service generated by goa design
package balance

import (
	"context"

	genBalance "github.com/oleshko-g/oggophermart/internal/gen/balance"
	"github.com/oleshko-g/oggophermart/internal/service/errors"
	"github.com/oleshko-g/oggophermart/internal/storage"
	"github.com/oleshko-g/oggophermart/internal/service"
)

// balance service example implementation.
// The example methods log the requests and return zero values.
type balanceSvc struct {
	storage.Balance
	service.Auther
}

var _ genBalance.Service = (*balanceSvc)(nil)
var _ genBalance.Auther = (*balanceSvc)(nil)

// New returns the balance service implementation.
func New(storage storage.Balance, auther service.Auther) *balanceSvc {
	return &balanceSvc{
		Balance: storage,
		Auther: auther,
	}
}

// PostOrder implements post order.
func (s *balanceSvc) UploadUserOrder(ctx context.Context, payload *genBalance.UploadUserOrderPayload) (res *genBalance.UploadUserOrderResult, err error) {
	// TODO: authenticate the user
	// TODO: check if order exists
	// TODO: If the user is the owner return "Accepted" == "yes"
	// TODO: If the user is not the owner return ErrOwnerMismatch
	// TODO: Store the order and return "Accepted" == nil
	return nil, errors.ErrNotImplemented
}
